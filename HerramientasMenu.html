
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
   <meta name="apple-mobile-web-app-capable" content="yes" />
   <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <link rel="stylesheet" href="jquery.mobile-1.1.0/jquery-mobile-960.min.css" />
    <link rel="stylesheet" href="jquery.mobile-1.1.0/jquery.mobile-1.1.0.min.css" />
    <link rel="stylesheet" type="text/css" href="jquery.mobile-1.1.0/jquery.mobile.simpledialog.min.css" /> 

    <script src="jquery.mobile-1.1.0/jquery-1.7.1.min.js"></script>
    <script src="jquery.mobile-1.1.0/jquery.mobile-1.1.0.min.js"></script>
    <script type="text/javascript" src="jquery.mobile-1.1.0/jquery.mobile.simpledialog2.min.js"></script>

    <script language="javascript" type="text/javascript" src="SBODatabase.js"></script>


</head>

 <script language="javascript" type="text/javascript">



     $(document).delegate('#opendialog', 'click', function () {

         if (confirm("Desea generar la Base de Datos ?")) {
             if (confirm("Se borrarán todos los datos existentes. Desea continuar ?"))
                 Initialize();
         }
     })

     var systemDB;

     function Initialize() {
         $.mobile.loadingMessageTextVisible = true;
         $.mobile.showPageLoadingMsg("a", "Inicializando Base de datos...", false);
         InitializeDatabase(successfunction, errorfunction);
         $.mobile.showPageLoadingMsg("a", "Generando tablas...", false);
         InitializeTables(successfunction, errorfunction);

         alert("'Base de Datos inicializada correctamente.");

     }


     function InitializeTestData() {
         $.mobile.loadingMessageTextVisible = true;
         $.mobile.showPageLoadingMsg("a", "Insertando datos de test...", false);
         InsertTestData(successfunction, errorfunction);
 
         alert("'Datos de test correctamente.");
     }

     $(document).delegate('#insertar', 'click', function () {
         if (confirm("Desea generar los datos de test ?"))
             InitializeTestData();
         
     })


    function GotoImportar() {

        try {

            if (window.navigator.onLine) {

                   myDB = OpenDatabase(successfunction, errorfunction);

                myDB.transaction(function (tx) {

                    tx.executeSql("SELECT SlpCode FROM AX_CONFIG", [], function (tx, result) {
                        dataset = result.rows;

                        if (dataset.length == 1) {
                            localStorage.clear();
                            var SlpCode = result.rows.item(0)['SlpCode'];

                            localStorage['SlpCode'] = SlpCode;
                            window.location.assign("HerramientasImportar.html");
          
                        }
                        else {
                            alert("Debe introducir el código de Comercial en Herramientas/Configuración para realizar la Importación de datos.");
                            return;
                        }
                    });

                });
            }
            else
                alert("Para realizar la importación debe tener conexión");

        } catch (e) {
            errorfunction(e);
        }

    }


     function successfunction() {
         $.mobile.hidePageLoadingMsg();
     }

     function errorfunction(e) {
         if (e == DOMException.INVALID_STATE_ERR) {

             alert("Invalid database version.");
         } else {
             alert("Unknown error " + e + ".");
         }
         $.mobile.hidePageLoadingMsg();
     }
</script>

<body>



         <div data-role="page" data-theme="c" >

	         <div data-role="header">
	            <a href="javascript:window.location.assign('index.html');" data-icon="home">Inicio</a>
	            <h1>Herramientas</h1>
            </div>

	        <div data-role="content">	

                <ul data-role="listview" data-inset="true">
                    <li data-role="list-divider">Menú Herramientas</li>
                    <li><a href="#" id="opendialog" data-ajax="false">Crear Base de Datos</a></li>
				    <li><a href="javascript:window.location.assign('HerramientasConfiguracion.html');" data-ajax="false">Configuración</a></li>
                    <!--<li><a href="#" id="insertar" data-ajax="false">Insertar datos de test</a></li>-->
                    <li><a href="javascript:GotoImportar();" data-ajax="false">Importación</a></li>
                    <li><a href="javascript:window.location.assign('HerramientasExportPedidos.html');" data-ajax="false">Exportación</a></li>
			    </ul>
 
     
            </div> 

              <div data-role="footer"  data-position="fixed" >
                    <div data-role="navbar" data-iconpos="top">
                        <ul>
                            <li><a href="javascript:window.location.assign('RuteroMenu.html');"  data-icon="back" >Rutero</a></li>
                            <li><a href="javascript:window.location.assign('VentasInicio.html');"  data-icon="plus" data-prefetch="true"  >Ventas/Visitas</a></li>
                            <li><a href="javascript:window.location.assign('ClientesGeneral.html');"  data-icon="back" >Interlocutores</a></li>
                            <li><a href="javascript:window.location.assign('Articulos.html');"  data-icon="back" >Articulos</a></li>
                        </ul>                
                </div>
            </div>

         </div>

</body>
 
 

</html>